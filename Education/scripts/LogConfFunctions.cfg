# Function to configure system logging and rotation
systemLogs()
{
	# Check to see if beenrun file exists. If not, create it.
	if [ ! -e $PWD/flags/systemLogs.txt ]; then
		echo "0" > $PWD/flags/systemLogs.txt || error_exit "$LINENO: File creation failed."
	fi
	beenrun=0

	# Read beenrun file. Run primary function if not run before, skip to else if it has been run already.
	read beenrun < $PWD/flags/systemLogs.txt || error_exit "$LINENO: Read failed."
	if [ "$beenrun" != 1 ]; then
		echo " "
		echo "############ Configuring system log rotation ############"
		echo "#########################################################"

		# set default log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.conf
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.conf || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.conf || error_exit "$LINENO: permissions change failed."
		sudo printf "\nweekly" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\nsu root syslog" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty\n" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf 'include /etc/logrotate.d' >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\n\n" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/wtmp {' >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate 0664 root utmp" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12\n" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\n\n" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/btmp {' >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate 0660 root utmp" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.conf || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.conf || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set apport log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/apport
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/apport || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/apport || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/apport || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/apport.log {' >> /etc/logrotate.d/apport || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/apport || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/apport || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/apport || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/apport || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/apport || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/apport || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/apport || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/apport || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/apport || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set apt log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/apt
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/apt || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/apt || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/apt/term.log {' >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\n\n" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/apt/history.log {' >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/apt || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/apt || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set clam-av daemon log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/clamav-daemon
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/clamav/clamav.log {' >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate 640 clamav adm" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
        	sudo printf "\npostrotate" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf 'if [ -d /run/systemd/system ]; then' >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf 'systemctl -q is-active clamav-daemon && systemctl kill --signal=SIGHUP clamav-daemon || true' >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf 'else' >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
        	sudo printf "\n" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf '/etc/init.d/clamav-daemon reload-log > /dev/null || true' >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf 'fi; \' >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
        	sudo printf "\nendscript" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/clamav-daemon || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set clam-av update log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/clamav-freshclam
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/clamav/clamav.log {' >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate 640 clamav adm" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
        	sudo printf "\npostrotate" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf 'if [ -d /run/systemd/system ]; then' >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf 'systemctl -q is-active clamav-freshclam && systemctl kill --signal=SIGHUP clamav-freshclam || true' >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf 'else' >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
        	sudo printf "\n" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf '/etc/init.d/clamav-freshclam reload-log > /dev/null || true' >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf 'fi; \' >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
        	sudo printf "\nendscript" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/clamav-freshclam || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set dpkg log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/dpkg
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/dpkg || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/dpkg || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/dpkg.log {' >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate 644 root root" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\n\n" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/alternatives.log {' >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate 644 root root" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/dpkg || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/dpkg || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set fail2ban log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/fail2ban
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/fail2ban || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/fail2ban || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/fail2ban.log {' >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
        	sudo printf "\npostrotate" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
		sudo printf 'fail2ban-client flushlogs 1>/dev/null' >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
        	sudo printf "\nendscript" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate 640 root adm" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/fail2ban || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/fail2ban || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set rkhunter log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/rkhunter
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/rkhunter || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/rkhunter || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/rkhunter || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/rkhunter.log {' >> /etc/logrotate.d/rkhunter || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/rkhunter || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/rkhunter || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/rkhunter || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/rkhunter || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/rkhunter || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/rkhunter || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate 640 root adm" >> /etc/logrotate.d/rkhunter || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/rkhunter || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/rkhunter || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/rkhunter || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set rsyslog log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/rsyslog
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/rsyslog || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/rsyslog || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/syslog {' >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\npostrotate" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf 'invoke-rc.d rsyslog rotate > /dev/null' >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\nendscript" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n\n" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/mail.info" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/mail.warn" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/mail.err" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/mail.log" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/daemon.log" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/kern.log" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/auth.log" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/user.log" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/lpr.log" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/cron.log" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/debug" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/messages" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf '{' >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\nsharedscripts" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\npostrotate" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf 'invoke-rc.d rsyslog rotate > /dev/null' >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\nendscript" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/rsyslog || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/rsyslog || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set ufw log rotation schedule (not really necessary as it isn't used. only set to be thorough)
		filestoreplace[$filecount]=/etc/logrotate.d/ufw
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/ufw || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/ufw || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/ufw.log {' >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf "\nsharedscripts" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf "\npostrotate" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf 'invoke-rc.d rsyslog rotate > /dev/null 2>&1 || true' >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf "\nendscript" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/ufw || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/ufw || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set unattended-upgrades log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/unattended-upgrades
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/unattended-upgrades/unattended-upgrades.log" >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf "\n/var/log/unattended-upgrades/unattended-upgrades-dpkg.log" >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/unattended-upgrades/unattended-upgrades-shutdown.log {' >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/unattended-upgrades || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		beenrun=1
		echo $beenrun > $PWD/flags/systemLogs.txt || error_exit "$LINENO: File edit failed."

		# Remove backed up files after complete
		cleanUpSuccessful;
		wait
	else
		return
	fi
}


# Function to enable Apache logs
apacheLogs()
{
	# Check to see if beenrun file exists. If not, create it.
	if [ ! -e $PWD/flags/apacheLogs.txt ]; then
		echo "0" > $PWD/flags/apacheLogs.txt || error_exit "$LINENO: File creation failed."
	fi
	beenrun=0

	# Read beenrun file. Run primary function if not run before, skip to else if it has been run already.
	read beenrun < $PWD/flags/apacheLogs.txt || error_exit "$LINENO: Read failed."
	if [ "$beenrun" != 1 ]; then

		# set Apache2 log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/apache2
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/apache2 || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/apache2 || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/apache2/*.log {' >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate 640 root adm" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
        	sudo printf "\nsharedscripts" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
        	sudo printf "\npostrotate" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf 'if /etc/init.d/apache2 status > /dev/null ; then \' >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf '/etc/init.d/apache2 reload > /dev/null; \' >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf 'fi;' >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
        	sudo printf "\n" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\nendscript" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
        	sudo printf "\nprerotate" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf 'if [ -d /etc/logrotate.d/httpd-prerotate ]; then \' >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf 'run-parts /etc/logrotate.d/httpd-prerotate; \' >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf 'fi; \' >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
        	sudo printf "\nendscript" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/apache2 || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/apache2 || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		beenrun=1
		echo $beenrun > $PWD/flags/apacheLogs.txt || error_exit "$LINENO: File edit failed."

		# Remove backed up files after complete
		cleanUpSuccessful;
		wait
	else
		return
	fi
}


# Function to enable owncloud logs
ownCloudLogs()
{
	# Check to see if beenrun file exists. If not, create it.
	if [ ! -e $PWD/flags/ownCloudLogs.txt ]; then
		echo "0" > $PWD/flags/ownCloudLogs.txt || error_exit "$LINENO: File creation failed."
	fi
	beenrun=0

	# Read beenrun file. Run primary function if not run before, skip to else if it has been run already.
	read beenrun < $PWD/flags/ownCloudLogs.txt || error_exit "$LINENO: Read failed."
	if [ "$beenrun" != 1 ]; then

		# set mysql log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/mysql-server
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/mysql-server || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/mysql-server || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/mysql/mysql.log /var/log/mysql/mysql-slow.log /var/log/mysql/mariadb-slow.log /var/log/mysql/error.log {' >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate 640 mysql adm" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
        	sudo printf "\nsharedscripts" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf "\npostrotate" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf 'test -x /usr/bin/mysqladmin || exit 0' >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf "\n\n" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf 'if [ -f `my_print_defaults --mysqld | grep -oP "pid-file=\K[^$]+"` ]; then' >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf '# If this fails, check debian.conf!' >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
                sudo printf "\n" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf 'mysqladmin --defaults-file=/etc/mysql/debian.cnf flush-logs' >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
        	sudo printf "\nfi" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
        	sudo printf "\nendscript" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/mysql-server || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/mysql-server || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set redis log rotation schedule
		filestoreplace[$filecount]=/etc/logrotate.d/redis-server
		sudo cp ${filestoreplace[$filecount]} ${filestoreplace[$filecount]}.back || error_exit "$LINENO: File backup failed."
		sudo truncate -s 0 /etc/logrotate.d/redis-server || error_exit "$LINENO: truncate file failed."
		sudo chmod 777 /etc/logrotate.d/redis-server || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/redis-server || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/redis/redis-server*.log {' >> /etc/logrotate.d/redis-server || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/redis-server || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/redis-server || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/redis-server || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/redis-server || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/redis-server || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/redis-server || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/redis-server || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/redis-server || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/redis-server || error_exit "$LINENO: permissions change failed."
		filecount=$((filecount+1))

		# set ownCloud log rotation schedule
		sudo echo "# ownCloud log rotation" | sudo tee /etc/logrotate.d/owncloud || error_exit "$LINENO: File creation failed."
		sudo chmod 777 /etc/logrotate.d/owncloud || error_exit "$LINENO: permissions change failed."
		sudo printf "\n" >> /etc/logrotate.d/owncloud || error_exit "$LINENO: File edit failed."
		sudo printf '/var/log/owncloud.log {' >> /etc/logrotate.d/owncloud || error_exit "$LINENO: File edit failed."
		sudo printf "\nweekly" >> /etc/logrotate.d/owncloud || error_exit "$LINENO: File edit failed."
		sudo printf "\nrotate 12" >> /etc/logrotate.d/owncloud || error_exit "$LINENO: File edit failed."
		sudo printf "\ncompress" >> /etc/logrotate.d/owncloud || error_exit "$LINENO: File edit failed."
		sudo printf "\ndelaycompress" >> /etc/logrotate.d/owncloud || error_exit "$LINENO: File edit failed."
		sudo printf "\nnotifempty" >> /etc/logrotate.d/owncloud || error_exit "$LINENO: File edit failed."
		sudo printf "\nmissingok" >> /etc/logrotate.d/owncloud || error_exit "$LINENO: File edit failed."
		sudo printf "\ncreate 640 www-data adm" >> /etc/logrotate.d/owncloud || error_exit "$LINENO: File edit failed."
		sudo printf "\n" >> /etc/logrotate.d/owncloud || error_exit "$LINENO: File edit failed."
		sudo printf '}' >> /etc/logrotate.d/owncloud || error_exit "$LINENO: File edit failed."
		sudo chmod 644 /etc/logrotate.d/owncloud || error_exit "$LINENO: permissions change failed."

		beenrun=1
		echo $beenrun > $PWD/flags/ownCloudLogs.txt || error_exit "$LINENO: File edit failed."

		# Remove backed up files after complete
		cleanUpSuccessful;
		wait
	else
		return
	fi
}
